<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>تحضير الطلاب - حلقة الإمام البخاري</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 30px; background: #f9f9f9; }
    h1 { color: #005f73; text-align: center; }
    .student { margin-bottom: 15px; }
    button { margin-top: 20px; padding: 10px 20px; }
  </style>
</head>
<body>
  <h1>تحضير الطلاب - حلقة الإمام البخاري</h1>
  <form id="attendanceForm">
    <div id="studentsContainer">
      <div class="student">
        <span>محمد موسى محمد</span><br>
        <label><input type="radio" name="محمد موسى محمد" value="حاضر" required> حاضر</label>
        <label><input type="radio" name="محمد موسى محمد" value="معتذر"> معتذر</label>
        <label><input type="radio" name="محمد موسى محمد" value="غائب"> غائب</label>
      </div>
      <div class="student">
        <span>عبدالكريم علي</span><br>
        <label><input type="radio" name="عبدالكريم علي" value="حاضر" required> حاضر</label>
        <label><input type="radio" name="عبدالكريم علي" value="معتذر"> معتذر</label>
        <label><input type="radio" name="عبدالكريم علي" value="غائب"> غائب</label>
      </div>
    </div>
    <input type="text" id="newStudent" placeholder="اسم جديد">
    <button type="button" onclick="addStudent()">إضافة طالب</button>
    <button type="submit">حفظ التحضير</button>
  </form>

  <script>
    const WEBAPP_URL = 'PASTE_YOUR_WEBAPP_URL_HERE';
    function addStudent() {
      const name = document.getElementById('newStudent').value.trim();
      if (!name) return alert('ادخل اسم الطالب');
      const div = document.createElement('div');
      div.className = 'student';
      div.innerHTML = `
        <span>${name}</span><br>
        <label><input type="radio" name="${name}" value="حاضر" required> حاضر</label>
        <label><input type="radio" name="${name}" value="معتذر"> معتذر</label>
        <label><input type="radio" name="${name}" value="غائب"> غائب</label>
      `;
      document.getElementById('studentsContainer').appendChild(div);
      document.getElementById('newStudent').value = '';
    }
    document.getElementById('attendanceForm').addEventListener('submit', e => {
      e.preventDefault();
      const data = {};
      const formData = new FormData(e.target);
      formData.forEach((v, k) => data[k] = v);
      fetch(WEBAPP_URL, {
        method: 'POST', headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ type: 'attendance', halqa: 'abudawood', data })
      })
      .then(res => res.json()).then(d => alert('تم الحفظ'))
      .catch(err => alert('خطأ: ' + err));
    });
  </script>
</body>
</html>
